<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
</head>
<body>
    
</body>

<script>


(function() { // Overriding XMLHttpRequest
    var oldXHR = window.XMLHttpRequest;
    var sum = 0;
    
    function newXHR() {
        var realXHR = new oldXHR();

        realXHR.addEventListener("readystatechange", function(e) { 
            if(e.target.readyState == 1){
                sum++;
            }

            if(e.target.readyState == 4){
                sum--;
            }

            if(sum == 0){
                /*======================
                execute the callback here.
                ========================*/
                console.log('CallBACK HERE')
            }
            
        }, false);

        return realXHR;
    }

    window.XMLHttpRequest = newXHR;
})();

    // var text = (function() {
    //     var proxied = window.XMLHttpRequest.prototype.send;
    //     var a = 0;
    //     window.XMLHttpRequest.prototype.send = function() {
    //         a++;
    //         console.log( arguments );
    //         //Here is where you can add any code to process the request. 
    //         //If you want to pass the Ajax request object, pass the 'pointer' below
    //         var pointer = this;
    //         var intervalId = window.setInterval(function(){

    //                 if(pointer.readyState != 4){
    //                         // return;
                           
    //                         console.log(a)
              
      
    //                         return;
    //                 }
    //                 // console.log('Ready', pointer.responseText );

    //                 // return pointer;
    //                 //Here is where you can add any code to process the response.
    //                 //If you want to pass the Ajax request object, pass the 'pointer' below
    //                 // debugger;
    //                 a--;
    //                 console.log("DONE",a)
    //                 clearInterval(intervalId);

    //                 return pointer;
                  
                 
    
    //         }, 1);//I found a delay of 1 to be sufficient, modify it as you need.
    //         return proxied.apply(this, [].slice.call(arguments));
    //     };
    
    
    // }());


    $.ajax({url:'http://jikan.me/api/anime/1'}).done(function(a){
        console.log('=============> 1 done',a)
    }).catch(function(a){
        console.log('=============> 1 error',a)
    });

    $.ajax({url:'http://jikan.me/api/anime/1'})
    .done(function(a){
        console.log('=============> 2 done',a)
    }).catch(function(a){
        console.log('=============> 1 error',a)
    });




    setTimeout(function(){
        $.ajax({url:'http://jikan.me/api/anime/1'}).done(function(){
        console.log('=============> 3 done')
    }).fail(function(){
        console.log('=============> 1 error',a)
    });
    },6000)


</script>
</html>